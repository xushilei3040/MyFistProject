{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "FisrtDataFactory1"
		},
		"AzureBlobStorage1_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureBlobStorage1'"
		},
		"AzureBlobStorage2lwy_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureBlobStorage2lwy'"
		},
		"FileServer1_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'FileServer1'"
		},
		"GoogleBigQueryForToken_clientSecret": {
			"type": "secureString",
			"metadata": "Secure string for 'clientSecret' of 'GoogleBigQueryForToken'"
		},
		"GoogleBigQueryForToken_refreshToken": {
			"type": "secureString",
			"metadata": "Secure string for 'refreshToken' of 'GoogleBigQueryForToken'"
		},
		"FileServer1_properties_typeProperties_host": {
			"type": "string",
			"defaultValue": "C:/"
		},
		"FileServer1_properties_typeProperties_userId": {
			"type": "string",
			"defaultValue": "admin123"
		},
		"GoogleBigQueryForToken_properties_typeProperties_clientId": {
			"type": "string",
			"defaultValue": "300837703532-f06sssljt2tlev086ji37ae68h98f6sn.apps.googleusercontent.com"
		},
		"trigger2_properties_typeProperties_scope": {
			"type": "string",
			"defaultValue": "/subscriptions/1e648c5c-e503-47bb-8c2c-da9b0a9ea771/resourceGroups/mytesttwogroup/providers/Microsoft.Storage/storageAccounts/fwdddpdls01"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/FWD_BIGQUERY_DATA_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GET BIGQUERY DATA COUNT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "GoogleBigQuerySource",
								"additionalColumns": [
									{
										"name": "dw_table_name",
										"value": "FirstTableDemo"
									},
									{
										"name": "dw_batch_num",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "dw_create_time",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								],
								"query": "SELECT * FROM `firebase-public-project.analytics_153293282.events_20181003`"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "event_date"
										},
										"sink": {
											"name": "event_date",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "event_timestamp",
											"type": "Int64"
										},
										"sink": {
											"name": "event_timestamp",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "event_name",
											"type": "String"
										},
										"sink": {
											"name": "event_name",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "event_params",
											"type": "String"
										},
										"sink": {
											"name": "event_params",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "event_previous_timestamp",
											"type": "Int64"
										},
										"sink": {
											"name": "event_previous_timestamp",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "event_value_in_usd",
											"type": "Double"
										},
										"sink": {
											"name": "event_value_in_usd",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "event_bundle_sequence_id",
											"type": "Int64"
										},
										"sink": {
											"name": "event_bundle_sequence_id",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "event_server_timestamp_offset",
											"type": "Int64"
										},
										"sink": {
											"name": "event_server_timestamp_offset",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "user_id",
											"type": "String"
										},
										"sink": {
											"name": "user_id",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "user_pseudo_id",
											"type": "String"
										},
										"sink": {
											"name": "user_pseudo_id",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "user_properties",
											"type": "String"
										},
										"sink": {
											"name": "user_properties",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "user_first_touch_timestamp",
											"type": "Int64"
										},
										"sink": {
											"name": "user_first_touch_timestamp",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "user_ltv",
											"type": "String"
										},
										"sink": {
											"name": "user_ltv",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "device",
											"type": "String"
										},
										"sink": {
											"name": "device",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "geo",
											"type": "String"
										},
										"sink": {
											"name": "geo",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "app_info",
											"type": "String"
										},
										"sink": {
											"name": "app_info",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "traffic_source",
											"type": "String"
										},
										"sink": {
											"name": "traffic_source",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "stream_id",
											"type": "String"
										},
										"sink": {
											"name": "stream_id",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "platform",
											"type": "String"
										},
										"sink": {
											"name": "platform",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "event_dimensions",
											"type": "String"
										},
										"sink": {
											"name": "event_dimensions",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GoogleBigQueryInput",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							}
						]
					},
					{
						"name": "CurrentTime",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyy-MM-dd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "GET BIGQUERY DATA COUNT",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "GoogleBigQuerySource",
								"query": "SELECT COUNT(1) FROM `firebase-public-project.analytics_153293282.events_20181003`"
							},
							"dataset": {
								"referenceName": "GoogleBigQueryInput",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(string(activity('GET BIGQUERY DATA COUNT').output.value[0].f0_) , string(activity('Copy data1').output.rowsCopied))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "UnValidated"
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ErrorDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ErrorDataPath": {
													"value": "@pipeline().parameters.ErrorDataPath",
													"type": "Expression"
												},
												"ErrorDataName": {
													"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "WRITE LOG_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "ERROR UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "ActivityName",
													"value": "if Condition1"
												},
												{
													"name": "PiplineName",
													"value": "FWD_BIGQUERY_DATA_PIPELINE"
												},
												{
													"name": "Date",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												},
												{
													"name": "Timestampse",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "ErrorCode",
													"value": "9000"
												},
												{
													"name": "Message",
													"value": "BigQuery中数据量与写入的目标文件不一致"
												},
												{
													"name": "status",
													"value": "Failed"
												}
											],
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ActivityName",
														"type": "String"
													},
													"sink": {
														"name": "ActivityName"
													}
												},
												{
													"source": {
														"name": "PiplineName",
														"type": "String"
													},
													"sink": {
														"name": "PiplineName"
													}
												},
												{
													"source": {
														"name": "Date",
														"type": "String"
													},
													"sink": {
														"name": "Date"
													}
												},
												{
													"source": {
														"name": "Timestampse",
														"type": "String"
													},
													"sink": {
														"name": "Timestampse"
													}
												},
												{
													"source": {
														"name": "ErrorCode",
														"type": "String"
													},
													"sink": {
														"name": "ErrorCode"
													}
												},
												{
													"source": {
														"name": "Message",
														"type": "String"
													},
													"sink": {
														"name": "Message"
													}
												},
												{
													"source": {
														"name": "status",
														"type": "String"
													},
													"sink": {
														"name": "status"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "dummp",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Logger",
											"type": "DatasetReference",
											"parameters": {
												"LogPath": {
													"value": "@pipeline().parameters.LogPath",
													"type": "Expression"
												},
												"LogName": {
													"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2_copy1",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "WRITE LOG_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "UnValidated"
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobStorageReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "dw_table_name",
													"value": "FirstTableDemo"
												},
												{
													"name": "dw_batch_num",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "dw_create_time",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												}
											],
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"validateDataConsistency": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "event_date",
														"type": "String"
													},
													"sink": {
														"name": "event_date",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "event_timestamp",
														"type": "Int64"
													},
													"sink": {
														"name": "event_timestamp",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "event_name",
														"type": "String"
													},
													"sink": {
														"name": "event_name",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "event_params",
														"type": "String"
													},
													"sink": {
														"name": "event_params",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "event_previous_timestamp",
														"type": "Int64"
													},
													"sink": {
														"name": "event_previous_timestamp",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "event_value_in_usd",
														"type": "Double"
													},
													"sink": {
														"name": "event_value_in_usd",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "event_bundle_sequence_id",
														"type": "Int64"
													},
													"sink": {
														"name": "event_bundle_sequence_id",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "event_server_timestamp_offset",
														"type": "Int64"
													},
													"sink": {
														"name": "event_server_timestamp_offset",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "user_id",
														"type": "String"
													},
													"sink": {
														"name": "user_id",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "user_pseudo_id",
														"type": "String"
													},
													"sink": {
														"name": "user_pseudo_id",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "user_properties",
														"type": "String"
													},
													"sink": {
														"name": "user_properties",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "user_first_touch_timestamp",
														"type": "Int64"
													},
													"sink": {
														"name": "user_first_touch_timestamp",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "user_ltv",
														"type": "String"
													},
													"sink": {
														"name": "user_ltv",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "device",
														"type": "String"
													},
													"sink": {
														"name": "device",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "geo",
														"type": "String"
													},
													"sink": {
														"name": "geo",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "app_info",
														"type": "String"
													},
													"sink": {
														"name": "app_info",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "traffic_source",
														"type": "String"
													},
													"sink": {
														"name": "traffic_source",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "stream_id",
														"type": "String"
													},
													"sink": {
														"name": "stream_id",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "platform",
														"type": "String"
													},
													"sink": {
														"name": "platform",
														"type": "String",
														"physicalType": "String"
													}
												},
												{
													"source": {
														"name": "event_dimensions",
														"type": "String"
													},
													"sink": {
														"name": "event_dimensions",
														"type": "String",
														"physicalType": "String"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "UnValidated"
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "Validated"
											}
										}
									]
								},
								{
									"name": "ARCHIVED",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "UnValidated"
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ArchivedDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ArchivedDataPath": "DATA\\PH\\FWD\\BIGQUERY\\ARCHIVED",
												"ArchivedDataName": {
													"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "ARCHIVED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "UnValidated"
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "AzureBlobStorageReadSettings",
											"recursive": true
										}
									}
								}
							]
						}
					},
					{
						"name": "ERROR BAK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "GoogleBigQuerySource",
								"additionalColumns": [
									{
										"name": "dw_table_name",
										"value": "FirstTableDemo"
									},
									{
										"name": "dw_batch_num",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "dw_create_time",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									}
								],
								"query": "SELECT * FROM `firebase-public-project.analytics_153293282.events_20181003`"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GoogleBigQueryInput",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ErrorDataSet",
								"type": "DatasetReference",
								"parameters": {
									"ErrorDataPath": {
										"value": "@pipeline().parameters.ErrorDataPath",
										"type": "Expression"
									},
									"ErrorDataName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "WRITE LOG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "FWD_BIGQUERY_DATA_PIPELINE"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName",
											"type": "String"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName",
											"type": "String"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date",
											"type": "String"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse",
											"type": "String"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode",
											"type": "String"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message",
											"type": "String"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status",
											"type": "String"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dummp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Logger",
								"type": "DatasetReference",
								"parameters": {
									"LogPath": {
										"value": "@pipeline().parameters.LogPath",
										"type": "Expression"
									},
									"LogName": {
										"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "DELETE1",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "ERROR BAK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							}
						}
					}
				],
				"parameters": {
					"DestionFilePath": {
						"type": "string"
					},
					"DestionFileName": {
						"type": "string",
						"defaultValue": "BigQueryFile"
					},
					"ErrorDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\BIGQUERY\\ERROR"
					},
					"ErrorDataName": {
						"type": "string",
						"defaultValue": "BigQueryFile"
					},
					"LogPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\LOG\\BIGQUERYLOG"
					},
					"LogName": {
						"type": "string",
						"defaultValue": "FWD_BIGQUERY_DATA_"
					}
				},
				"variables": {
					"CurrentTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/GoogleBigQueryInput')]",
				"[concat(variables('factoryId'), '/datasets/DestionDataSet')]",
				"[concat(variables('factoryId'), '/datasets/ErrorDataSet')]",
				"[concat(variables('factoryId'), '/datasets/dummp')]",
				"[concat(variables('factoryId'), '/datasets/Logger')]",
				"[concat(variables('factoryId'), '/datasets/ArchivedDataSet')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FWD_IRIS01_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SOURCE FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "qwe123"
										},
										"sink": {
											"name": "qwe"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							}
						]
					},
					{
						"name": "VALIDATION",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "CURREN TTIME",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "VALIDATION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentDate",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ERROR BAK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ErrorDataSet",
								"type": "DatasetReference",
								"parameters": {
									"ErrorDataPath": {
										"value": "@pipeline().parameters.ErrorDataPath",
										"type": "Expression"
									},
									"ErrorDataName": {
										"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "WRITE LOG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "FWD_IRIS01_PIPELINE"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName",
											"type": "String"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName",
											"type": "String"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date",
											"type": "String"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse",
											"type": "String"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode",
											"type": "String"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message",
											"type": "String"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status",
											"type": "String"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dummp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Logger",
								"type": "DatasetReference",
								"parameters": {
									"LogPath": {
										"value": "@pipeline().parameters.LogPath",
										"type": "Expression"
									},
									"LogName": {
										"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "DELETE1",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "ERROR BAK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							}
						}
					},
					{
						"name": "SOURCE FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "CURREN TTIME",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "FileServerReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "DESTION FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "DESTION FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(string(activity('SOURCE FILE SIZE').output.size),string(activity('DESTION FILE SIZE').output.size))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ErrorDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ErrorDataPath": {
													"value": "@pipeline().parameters.ErrorDataPath",
													"type": "Expression"
												},
												"ErrorDataName": {
													"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "WRITE LOG_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "ERROR UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "ActivityName",
													"value": "if Condition1"
												},
												{
													"name": "PiplineName",
													"value": "FWD_IRIS01_PIPELINE"
												},
												{
													"name": "Date",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												},
												{
													"name": "Timestampse",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "ErrorCode",
													"value": "9000"
												},
												{
													"name": "Message",
													"value": "源文件IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv与目标文件大小不一致"
												},
												{
													"name": "status",
													"value": "Failed"
												}
											],
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ActivityName",
														"type": "String"
													},
													"sink": {
														"name": "ActivityName"
													}
												},
												{
													"source": {
														"name": "PiplineName",
														"type": "String"
													},
													"sink": {
														"name": "PiplineName"
													}
												},
												{
													"source": {
														"name": "Date",
														"type": "String"
													},
													"sink": {
														"name": "Date"
													}
												},
												{
													"source": {
														"name": "Timestampse",
														"type": "String"
													},
													"sink": {
														"name": "Timestampse"
													}
												},
												{
													"source": {
														"name": "ErrorCode",
														"type": "String"
													},
													"sink": {
														"name": "ErrorCode"
													}
												},
												{
													"source": {
														"name": "Message",
														"type": "String"
													},
													"sink": {
														"name": "Message"
													}
												},
												{
													"source": {
														"name": "status",
														"type": "String"
													},
													"sink": {
														"name": "status"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "dummp",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Logger",
											"type": "DatasetReference",
											"parameters": {
												"LogPath": {
													"value": "@pipeline().parameters.LogPath",
													"type": "Expression"
												},
												"LogName": {
													"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2_copy1",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "WRITE LOG_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "ARCHIVED",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ArchivedDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ArchivedDataPath": {
													"value": "@pipeline().parameters.ArchivedDataPath",
													"type": "Expression"
												},
												"ArchivedDataName": {
													"value": "@concat(pipeline().parameters.ArchivedDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "ARCHIVED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								},
								{
									"name": "UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "Validated"
											}
										}
									]
								}
							]
						}
					}
				],
				"parameters": {
					"SourceDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\PROCESS"
					},
					"SourceDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv"
					},
					"DestionDataPath": {
						"type": "string"
					},
					"DestionDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ArchivedDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ARCHIVED"
					},
					"ArchivedDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ErrorDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ERROR"
					},
					"ErrorDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"LogPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\LOG\\IRISLOG"
					},
					"LogName": {
						"type": "string",
						"defaultValue": "FWD_BigQuery_Data_"
					}
				},
				"variables": {
					"CurrentDate": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataSet')]",
				"[concat(variables('factoryId'), '/datasets/DestionDataSet')]",
				"[concat(variables('factoryId'), '/datasets/ErrorDataSet')]",
				"[concat(variables('factoryId'), '/datasets/dummp')]",
				"[concat(variables('factoryId'), '/datasets/Logger')]",
				"[concat(variables('factoryId'), '/datasets/ArchivedDataSet')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FWD_IRIS02_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SOURCE FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							}
						]
					},
					{
						"name": "VALIDATION",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "CURREN TTIME",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "VALIDATION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentDate",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ERROR BAK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ErrorDataSet",
								"type": "DatasetReference",
								"parameters": {
									"ErrorDataPath": {
										"value": "@pipeline().parameters.ErrorDataPath",
										"type": "Expression"
									},
									"ErrorDataName": {
										"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "WRITE LOG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "FWD_IRIS01_PIPELINE"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName",
											"type": "String"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName",
											"type": "String"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date",
											"type": "String"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse",
											"type": "String"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode",
											"type": "String"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message",
											"type": "String"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status",
											"type": "String"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dummp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Logger",
								"type": "DatasetReference",
								"parameters": {
									"LogPath": {
										"value": "@pipeline().parameters.LogPath",
										"type": "Expression"
									},
									"LogName": {
										"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "DELETE1",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "ERROR BAK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							}
						}
					},
					{
						"name": "SOURCE FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "CURREN TTIME",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "FileServerReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "DESTION FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "DESTION FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(string(activity('SOURCE FILE SIZE').output.size),string(activity('DESTION FILE SIZE').output.size))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ErrorDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ErrorDataPath": {
													"value": "@pipeline().parameters.ErrorDataPath",
													"type": "Expression"
												},
												"ErrorDataName": {
													"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "WRITE LOG_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "ERROR UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "ActivityName",
													"value": "if Condition1"
												},
												{
													"name": "PiplineName",
													"value": "FWD_IRIS01_PIPELINE"
												},
												{
													"name": "Date",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												},
												{
													"name": "Timestampse",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "ErrorCode",
													"value": "9000"
												},
												{
													"name": "Message",
													"value": "源文件IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv与目标文件大小不一致"
												},
												{
													"name": "status",
													"value": "Failed"
												}
											],
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ActivityName",
														"type": "String"
													},
													"sink": {
														"name": "ActivityName"
													}
												},
												{
													"source": {
														"name": "PiplineName",
														"type": "String"
													},
													"sink": {
														"name": "PiplineName"
													}
												},
												{
													"source": {
														"name": "Date",
														"type": "String"
													},
													"sink": {
														"name": "Date"
													}
												},
												{
													"source": {
														"name": "Timestampse",
														"type": "String"
													},
													"sink": {
														"name": "Timestampse"
													}
												},
												{
													"source": {
														"name": "ErrorCode",
														"type": "String"
													},
													"sink": {
														"name": "ErrorCode"
													}
												},
												{
													"source": {
														"name": "Message",
														"type": "String"
													},
													"sink": {
														"name": "Message"
													}
												},
												{
													"source": {
														"name": "status",
														"type": "String"
													},
													"sink": {
														"name": "status"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "dummp",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Logger",
											"type": "DatasetReference",
											"parameters": {
												"LogPath": {
													"value": "@pipeline().parameters.LogPath",
													"type": "Expression"
												},
												"LogName": {
													"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2_copy1",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "WRITE LOG_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "ARCHIVED",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ArchivedDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ArchivedDataPath": {
													"value": "@pipeline().parameters.ArchivedDataPath",
													"type": "Expression"
												},
												"ArchivedDataName": {
													"value": "@concat(pipeline().parameters.ArchivedDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "ARCHIVED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								},
								{
									"name": "UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "Validated"
											}
										}
									]
								}
							]
						}
					}
				],
				"parameters": {
					"SourceDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\PROCESS"
					},
					"SourceDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv"
					},
					"DestionDataPath": {
						"type": "string"
					},
					"DestionDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ArchivedDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ARCHIVED"
					},
					"ArchivedDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ErrorDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ERROR"
					},
					"ErrorDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"LogPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\LOG\\IRISLOG"
					},
					"LogName": {
						"type": "string",
						"defaultValue": "FWD_BigQuery_Data_"
					}
				},
				"variables": {
					"CurrentDate": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataSet')]",
				"[concat(variables('factoryId'), '/datasets/DestionDataSet')]",
				"[concat(variables('factoryId'), '/datasets/ErrorDataSet')]",
				"[concat(variables('factoryId'), '/datasets/dummp')]",
				"[concat(variables('factoryId'), '/datasets/Logger')]",
				"[concat(variables('factoryId'), '/datasets/ArchivedDataSet')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FWD_IRIS03_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SOURCE FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							}
						]
					},
					{
						"name": "VALIDATION",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "CURREN TTIME",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "VALIDATION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentDate",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ERROR BAK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ErrorDataSet",
								"type": "DatasetReference",
								"parameters": {
									"ErrorDataPath": {
										"value": "@pipeline().parameters.ErrorDataPath",
										"type": "Expression"
									},
									"ErrorDataName": {
										"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "WRITE LOG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "FWD_IRIS01_PIPELINE"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName",
											"type": "String"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName",
											"type": "String"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date",
											"type": "String"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse",
											"type": "String"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode",
											"type": "String"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message",
											"type": "String"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status",
											"type": "String"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dummp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Logger",
								"type": "DatasetReference",
								"parameters": {
									"LogPath": {
										"value": "@pipeline().parameters.LogPath",
										"type": "Expression"
									},
									"LogName": {
										"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "DELETE1",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "ERROR BAK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							}
						}
					},
					{
						"name": "SOURCE FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "CURREN TTIME",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "FileServerReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "DESTION FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "DESTION FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(string(activity('SOURCE FILE SIZE').output.size),string(activity('DESTION FILE SIZE').output.size))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ErrorDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ErrorDataPath": {
													"value": "@pipeline().parameters.ErrorDataPath",
													"type": "Expression"
												},
												"ErrorDataName": {
													"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "WRITE LOG_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "ERROR UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "ActivityName",
													"value": "if Condition1"
												},
												{
													"name": "PiplineName",
													"value": "FWD_IRIS01_PIPELINE"
												},
												{
													"name": "Date",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												},
												{
													"name": "Timestampse",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "ErrorCode",
													"value": "9000"
												},
												{
													"name": "Message",
													"value": "源文件IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv与目标文件大小不一致"
												},
												{
													"name": "status",
													"value": "Failed"
												}
											],
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ActivityName",
														"type": "String"
													},
													"sink": {
														"name": "ActivityName"
													}
												},
												{
													"source": {
														"name": "PiplineName",
														"type": "String"
													},
													"sink": {
														"name": "PiplineName"
													}
												},
												{
													"source": {
														"name": "Date",
														"type": "String"
													},
													"sink": {
														"name": "Date"
													}
												},
												{
													"source": {
														"name": "Timestampse",
														"type": "String"
													},
													"sink": {
														"name": "Timestampse"
													}
												},
												{
													"source": {
														"name": "ErrorCode",
														"type": "String"
													},
													"sink": {
														"name": "ErrorCode"
													}
												},
												{
													"source": {
														"name": "Message",
														"type": "String"
													},
													"sink": {
														"name": "Message"
													}
												},
												{
													"source": {
														"name": "status",
														"type": "String"
													},
													"sink": {
														"name": "status"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "dummp",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Logger",
											"type": "DatasetReference",
											"parameters": {
												"LogPath": {
													"value": "@pipeline().parameters.LogPath",
													"type": "Expression"
												},
												"LogName": {
													"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2_copy1",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "WRITE LOG_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "ARCHIVED",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ArchivedDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ArchivedDataPath": {
													"value": "@pipeline().parameters.ArchivedDataPath",
													"type": "Expression"
												},
												"ArchivedDataName": {
													"value": "@concat(pipeline().parameters.ArchivedDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "ARCHIVED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								},
								{
									"name": "UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "Validated"
											}
										}
									]
								}
							]
						}
					}
				],
				"parameters": {
					"SourceDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\PROCESS"
					},
					"SourceDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv"
					},
					"DestionDataPath": {
						"type": "string"
					},
					"DestionDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ArchivedDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ARCHIVED"
					},
					"ArchivedDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ErrorDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ERROR"
					},
					"ErrorDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"LogPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\LOG\\IRISLOG"
					},
					"LogName": {
						"type": "string",
						"defaultValue": "FWD_BigQuery_Data_"
					}
				},
				"variables": {
					"CurrentDate": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataSet')]",
				"[concat(variables('factoryId'), '/datasets/DestionDataSet')]",
				"[concat(variables('factoryId'), '/datasets/ErrorDataSet')]",
				"[concat(variables('factoryId'), '/datasets/dummp')]",
				"[concat(variables('factoryId'), '/datasets/Logger')]",
				"[concat(variables('factoryId'), '/datasets/ArchivedDataSet')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FWD_IRIS05_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SOURCE FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							}
						]
					},
					{
						"name": "VALIDATION",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "CURREN TTIME",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "VALIDATION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentDate",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ERROR BAK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ErrorDataSet",
								"type": "DatasetReference",
								"parameters": {
									"ErrorDataPath": {
										"value": "@pipeline().parameters.ErrorDataPath",
										"type": "Expression"
									},
									"ErrorDataName": {
										"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "WRITE LOG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "FWD_IRIS01_PIPELINE"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName",
											"type": "String"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName",
											"type": "String"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date",
											"type": "String"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse",
											"type": "String"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode",
											"type": "String"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message",
											"type": "String"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status",
											"type": "String"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dummp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Logger",
								"type": "DatasetReference",
								"parameters": {
									"LogPath": {
										"value": "@pipeline().parameters.LogPath",
										"type": "Expression"
									},
									"LogName": {
										"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "DELETE1",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "ERROR BAK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							}
						}
					},
					{
						"name": "SOURCE FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "CURREN TTIME",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "FileServerReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "DESTION FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "DESTION FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(string(activity('SOURCE FILE SIZE').output.size),string(activity('DESTION FILE SIZE').output.size))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ErrorDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ErrorDataPath": {
													"value": "@pipeline().parameters.ErrorDataPath",
													"type": "Expression"
												},
												"ErrorDataName": {
													"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "WRITE LOG_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "ERROR UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "ActivityName",
													"value": "if Condition1"
												},
												{
													"name": "PiplineName",
													"value": "FWD_IRIS01_PIPELINE"
												},
												{
													"name": "Date",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												},
												{
													"name": "Timestampse",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "ErrorCode",
													"value": "9000"
												},
												{
													"name": "Message",
													"value": "源文件IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv与目标文件大小不一致"
												},
												{
													"name": "status",
													"value": "Failed"
												}
											],
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ActivityName",
														"type": "String"
													},
													"sink": {
														"name": "ActivityName"
													}
												},
												{
													"source": {
														"name": "PiplineName",
														"type": "String"
													},
													"sink": {
														"name": "PiplineName"
													}
												},
												{
													"source": {
														"name": "Date",
														"type": "String"
													},
													"sink": {
														"name": "Date"
													}
												},
												{
													"source": {
														"name": "Timestampse",
														"type": "String"
													},
													"sink": {
														"name": "Timestampse"
													}
												},
												{
													"source": {
														"name": "ErrorCode",
														"type": "String"
													},
													"sink": {
														"name": "ErrorCode"
													}
												},
												{
													"source": {
														"name": "Message",
														"type": "String"
													},
													"sink": {
														"name": "Message"
													}
												},
												{
													"source": {
														"name": "status",
														"type": "String"
													},
													"sink": {
														"name": "status"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "dummp",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Logger",
											"type": "DatasetReference",
											"parameters": {
												"LogPath": {
													"value": "@pipeline().parameters.LogPath",
													"type": "Expression"
												},
												"LogName": {
													"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2_copy1",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "WRITE LOG_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "ARCHIVED",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ArchivedDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ArchivedDataPath": {
													"value": "@pipeline().parameters.ArchivedDataPath",
													"type": "Expression"
												},
												"ArchivedDataName": {
													"value": "@concat(pipeline().parameters.ArchivedDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "ARCHIVED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								},
								{
									"name": "UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "Validated"
											}
										}
									]
								}
							]
						}
					}
				],
				"parameters": {
					"SourceDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\PROCESS"
					},
					"SourceDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv"
					},
					"DestionDataPath": {
						"type": "string"
					},
					"DestionDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ArchivedDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ARCHIVED"
					},
					"ArchivedDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ErrorDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ERROR"
					},
					"ErrorDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"LogPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\LOG\\IRISLOG"
					},
					"LogName": {
						"type": "string",
						"defaultValue": "FWD_BigQuery_Data_"
					}
				},
				"variables": {
					"CurrentDate": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataSet')]",
				"[concat(variables('factoryId'), '/datasets/DestionDataSet')]",
				"[concat(variables('factoryId'), '/datasets/ErrorDataSet')]",
				"[concat(variables('factoryId'), '/datasets/dummp')]",
				"[concat(variables('factoryId'), '/datasets/Logger')]",
				"[concat(variables('factoryId'), '/datasets/ArchivedDataSet')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FWD_NON-UWME_ACTIVE_USERS_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SOURCE FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							}
						]
					},
					{
						"name": "VALIDATION",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "CURREN TTIME",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "VALIDATION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentDate",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ERROR BAK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ErrorDataSet",
								"type": "DatasetReference",
								"parameters": {
									"ErrorDataPath": {
										"value": "@pipeline().parameters.ErrorDataPath",
										"type": "Expression"
									},
									"ErrorDataName": {
										"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "WRITE LOG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "FWD_IRIS01_PIPELINE"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName",
											"type": "String"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName",
											"type": "String"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date",
											"type": "String"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse",
											"type": "String"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode",
											"type": "String"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message",
											"type": "String"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status",
											"type": "String"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dummp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Logger",
								"type": "DatasetReference",
								"parameters": {
									"LogPath": {
										"value": "@pipeline().parameters.LogPath",
										"type": "Expression"
									},
									"LogName": {
										"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "DELETE1",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "ERROR BAK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							}
						}
					},
					{
						"name": "SOURCE FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "CURREN TTIME",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "FileServerReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "DESTION FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "DESTION FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(string(activity('SOURCE FILE SIZE').output.size),string(activity('DESTION FILE SIZE').output.size))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ErrorDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ErrorDataPath": {
													"value": "@pipeline().parameters.ErrorDataPath",
													"type": "Expression"
												},
												"ErrorDataName": {
													"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "WRITE LOG_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "ERROR UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "ActivityName",
													"value": "if Condition1"
												},
												{
													"name": "PiplineName",
													"value": "FWD_IRIS01_PIPELINE"
												},
												{
													"name": "Date",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												},
												{
													"name": "Timestampse",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "ErrorCode",
													"value": "9000"
												},
												{
													"name": "Message",
													"value": "源文件IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv与目标文件大小不一致"
												},
												{
													"name": "status",
													"value": "Failed"
												}
											],
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ActivityName",
														"type": "String"
													},
													"sink": {
														"name": "ActivityName"
													}
												},
												{
													"source": {
														"name": "PiplineName",
														"type": "String"
													},
													"sink": {
														"name": "PiplineName"
													}
												},
												{
													"source": {
														"name": "Date",
														"type": "String"
													},
													"sink": {
														"name": "Date"
													}
												},
												{
													"source": {
														"name": "Timestampse",
														"type": "String"
													},
													"sink": {
														"name": "Timestampse"
													}
												},
												{
													"source": {
														"name": "ErrorCode",
														"type": "String"
													},
													"sink": {
														"name": "ErrorCode"
													}
												},
												{
													"source": {
														"name": "Message",
														"type": "String"
													},
													"sink": {
														"name": "Message"
													}
												},
												{
													"source": {
														"name": "status",
														"type": "String"
													},
													"sink": {
														"name": "status"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "dummp",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Logger",
											"type": "DatasetReference",
											"parameters": {
												"LogPath": {
													"value": "@pipeline().parameters.LogPath",
													"type": "Expression"
												},
												"LogName": {
													"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2_copy1",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "WRITE LOG_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "ARCHIVED",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ArchivedDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ArchivedDataPath": {
													"value": "@pipeline().parameters.ArchivedDataPath",
													"type": "Expression"
												},
												"ArchivedDataName": {
													"value": "@concat(pipeline().parameters.ArchivedDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "ARCHIVED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								},
								{
									"name": "UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "Validated"
											}
										}
									]
								}
							]
						}
					}
				],
				"parameters": {
					"SourceDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\PROCESS"
					},
					"SourceDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv"
					},
					"DestionDataPath": {
						"type": "string"
					},
					"DestionDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ArchivedDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ARCHIVED"
					},
					"ArchivedDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ErrorDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ERROR"
					},
					"ErrorDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"LogPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\LOG\\EAPPLOG"
					},
					"LogName": {
						"type": "string",
						"defaultValue": "FWD_BigQuery_Data_"
					}
				},
				"variables": {
					"CurrentDate": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataSet')]",
				"[concat(variables('factoryId'), '/datasets/DestionDataSet')]",
				"[concat(variables('factoryId'), '/datasets/ErrorDataSet')]",
				"[concat(variables('factoryId'), '/datasets/dummp')]",
				"[concat(variables('factoryId'), '/datasets/Logger')]",
				"[concat(variables('factoryId'), '/datasets/ArchivedDataSet')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FWD_NON-UWME_SUBMISSIONS-RIDER_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SOURCE FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							}
						]
					},
					{
						"name": "VALIDATION",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "CURREN TTIME",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "VALIDATION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentDate",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ERROR BAK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ErrorDataSet",
								"type": "DatasetReference",
								"parameters": {
									"ErrorDataPath": {
										"value": "@pipeline().parameters.ErrorDataPath",
										"type": "Expression"
									},
									"ErrorDataName": {
										"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "WRITE LOG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "FWD_IRIS01_PIPELINE"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName",
											"type": "String"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName",
											"type": "String"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date",
											"type": "String"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse",
											"type": "String"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode",
											"type": "String"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message",
											"type": "String"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status",
											"type": "String"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dummp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Logger",
								"type": "DatasetReference",
								"parameters": {
									"LogPath": {
										"value": "@pipeline().parameters.LogPath",
										"type": "Expression"
									},
									"LogName": {
										"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "DELETE1",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "ERROR BAK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							}
						}
					},
					{
						"name": "SOURCE FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "CURREN TTIME",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "FileServerReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "DESTION FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "DESTION FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(string(activity('SOURCE FILE SIZE').output.size),string(activity('DESTION FILE SIZE').output.size))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ErrorDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ErrorDataPath": {
													"value": "@pipeline().parameters.ErrorDataPath",
													"type": "Expression"
												},
												"ErrorDataName": {
													"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "WRITE LOG_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "ERROR UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "ActivityName",
													"value": "if Condition1"
												},
												{
													"name": "PiplineName",
													"value": "FWD_IRIS01_PIPELINE"
												},
												{
													"name": "Date",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												},
												{
													"name": "Timestampse",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "ErrorCode",
													"value": "9000"
												},
												{
													"name": "Message",
													"value": "源文件IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv与目标文件大小不一致"
												},
												{
													"name": "status",
													"value": "Failed"
												}
											],
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ActivityName",
														"type": "String"
													},
													"sink": {
														"name": "ActivityName"
													}
												},
												{
													"source": {
														"name": "PiplineName",
														"type": "String"
													},
													"sink": {
														"name": "PiplineName"
													}
												},
												{
													"source": {
														"name": "Date",
														"type": "String"
													},
													"sink": {
														"name": "Date"
													}
												},
												{
													"source": {
														"name": "Timestampse",
														"type": "String"
													},
													"sink": {
														"name": "Timestampse"
													}
												},
												{
													"source": {
														"name": "ErrorCode",
														"type": "String"
													},
													"sink": {
														"name": "ErrorCode"
													}
												},
												{
													"source": {
														"name": "Message",
														"type": "String"
													},
													"sink": {
														"name": "Message"
													}
												},
												{
													"source": {
														"name": "status",
														"type": "String"
													},
													"sink": {
														"name": "status"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "dummp",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Logger",
											"type": "DatasetReference",
											"parameters": {
												"LogPath": {
													"value": "@pipeline().parameters.LogPath",
													"type": "Expression"
												},
												"LogName": {
													"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2_copy1",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "WRITE LOG_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "ARCHIVED",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ArchivedDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ArchivedDataPath": {
													"value": "@pipeline().parameters.ArchivedDataPath",
													"type": "Expression"
												},
												"ArchivedDataName": {
													"value": "@concat(pipeline().parameters.ArchivedDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "ARCHIVED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								},
								{
									"name": "UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "Validated"
											}
										}
									]
								}
							]
						}
					}
				],
				"parameters": {
					"SourceDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\PROCESS"
					},
					"SourceDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv"
					},
					"DestionDataPath": {
						"type": "string"
					},
					"DestionDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ArchivedDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ARCHIVED"
					},
					"ArchivedDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ErrorDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ERROR"
					},
					"ErrorDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"LogPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\LOG\\EAPPLOG"
					},
					"LogName": {
						"type": "string",
						"defaultValue": "FWD_BigQuery_Data_"
					}
				},
				"variables": {
					"CurrentDate": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataSet')]",
				"[concat(variables('factoryId'), '/datasets/DestionDataSet')]",
				"[concat(variables('factoryId'), '/datasets/ErrorDataSet')]",
				"[concat(variables('factoryId'), '/datasets/dummp')]",
				"[concat(variables('factoryId'), '/datasets/Logger')]",
				"[concat(variables('factoryId'), '/datasets/ArchivedDataSet')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FWD_SALESPORTAL_PTL_LOGIN_LOG_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SOURCE FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							}
						]
					},
					{
						"name": "VALIDATION",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "CURREN TTIME",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "VALIDATION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentDate",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ERROR BAK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ErrorDataSet",
								"type": "DatasetReference",
								"parameters": {
									"ErrorDataPath": {
										"value": "@pipeline().parameters.ErrorDataPath",
										"type": "Expression"
									},
									"ErrorDataName": {
										"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "WRITE LOG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "FWD_IRIS01_PIPELINE"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName",
											"type": "String"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName",
											"type": "String"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date",
											"type": "String"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse",
											"type": "String"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode",
											"type": "String"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message",
											"type": "String"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status",
											"type": "String"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dummp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Logger",
								"type": "DatasetReference",
								"parameters": {
									"LogPath": {
										"value": "@pipeline().parameters.LogPath",
										"type": "Expression"
									},
									"LogName": {
										"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "DELETE1",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "ERROR BAK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							}
						}
					},
					{
						"name": "SOURCE FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "CURREN TTIME",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "FileServerReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "DESTION FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "DESTION FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(string(activity('SOURCE FILE SIZE').output.size),string(activity('DESTION FILE SIZE').output.size))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ErrorDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ErrorDataPath": {
													"value": "@pipeline().parameters.ErrorDataPath",
													"type": "Expression"
												},
												"ErrorDataName": {
													"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "WRITE LOG_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "ERROR UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "ActivityName",
													"value": "if Condition1"
												},
												{
													"name": "PiplineName",
													"value": "FWD_IRIS01_PIPELINE"
												},
												{
													"name": "Date",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												},
												{
													"name": "Timestampse",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "ErrorCode",
													"value": "9000"
												},
												{
													"name": "Message",
													"value": "源文件IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv与目标文件大小不一致"
												},
												{
													"name": "status",
													"value": "Failed"
												}
											],
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ActivityName",
														"type": "String"
													},
													"sink": {
														"name": "ActivityName"
													}
												},
												{
													"source": {
														"name": "PiplineName",
														"type": "String"
													},
													"sink": {
														"name": "PiplineName"
													}
												},
												{
													"source": {
														"name": "Date",
														"type": "String"
													},
													"sink": {
														"name": "Date"
													}
												},
												{
													"source": {
														"name": "Timestampse",
														"type": "String"
													},
													"sink": {
														"name": "Timestampse"
													}
												},
												{
													"source": {
														"name": "ErrorCode",
														"type": "String"
													},
													"sink": {
														"name": "ErrorCode"
													}
												},
												{
													"source": {
														"name": "Message",
														"type": "String"
													},
													"sink": {
														"name": "Message"
													}
												},
												{
													"source": {
														"name": "status",
														"type": "String"
													},
													"sink": {
														"name": "status"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "dummp",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Logger",
											"type": "DatasetReference",
											"parameters": {
												"LogPath": {
													"value": "@pipeline().parameters.LogPath",
													"type": "Expression"
												},
												"LogName": {
													"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2_copy1",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "WRITE LOG_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "ARCHIVED",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ArchivedDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ArchivedDataPath": {
													"value": "@pipeline().parameters.ArchivedDataPath",
													"type": "Expression"
												},
												"ArchivedDataName": {
													"value": "@concat(pipeline().parameters.ArchivedDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "ARCHIVED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								},
								{
									"name": "UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "Validated"
											}
										}
									]
								}
							]
						}
					}
				],
				"parameters": {
					"SourceDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\PROCESS"
					},
					"SourceDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv"
					},
					"DestionDataPath": {
						"type": "string"
					},
					"DestionDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ArchivedDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ARCHIVED"
					},
					"ArchivedDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ErrorDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ERROR"
					},
					"ErrorDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"LogPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\LOG\\IRISLOG"
					},
					"LogName": {
						"type": "string",
						"defaultValue": "FWD_BigQuery_Data_"
					}
				},
				"variables": {
					"CurrentDate": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataSet')]",
				"[concat(variables('factoryId'), '/datasets/DestionDataSet')]",
				"[concat(variables('factoryId'), '/datasets/ErrorDataSet')]",
				"[concat(variables('factoryId'), '/datasets/dummp')]",
				"[concat(variables('factoryId'), '/datasets/Logger')]",
				"[concat(variables('factoryId'), '/datasets/ArchivedDataSet')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FWD_SALESPORTAL_PTL_LOGIN_MAPPING_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SOURCE FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							}
						]
					},
					{
						"name": "VALIDATION",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "CURREN TTIME",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "VALIDATION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentDate",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ERROR BAK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ErrorDataSet",
								"type": "DatasetReference",
								"parameters": {
									"ErrorDataPath": {
										"value": "@pipeline().parameters.ErrorDataPath",
										"type": "Expression"
									},
									"ErrorDataName": {
										"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "WRITE LOG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "FWD_IRIS01_PIPELINE"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName",
											"type": "String"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName",
											"type": "String"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date",
											"type": "String"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse",
											"type": "String"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode",
											"type": "String"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message",
											"type": "String"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status",
											"type": "String"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dummp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Logger",
								"type": "DatasetReference",
								"parameters": {
									"LogPath": {
										"value": "@pipeline().parameters.LogPath",
										"type": "Expression"
									},
									"LogName": {
										"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "DELETE1",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "ERROR BAK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							}
						}
					},
					{
						"name": "SOURCE FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "CURREN TTIME",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "FileServerReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "DESTION FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "DESTION FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(string(activity('SOURCE FILE SIZE').output.size),string(activity('DESTION FILE SIZE').output.size))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ErrorDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ErrorDataPath": {
													"value": "@pipeline().parameters.ErrorDataPath",
													"type": "Expression"
												},
												"ErrorDataName": {
													"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "WRITE LOG_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "ERROR UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "ActivityName",
													"value": "if Condition1"
												},
												{
													"name": "PiplineName",
													"value": "FWD_IRIS01_PIPELINE"
												},
												{
													"name": "Date",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												},
												{
													"name": "Timestampse",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "ErrorCode",
													"value": "9000"
												},
												{
													"name": "Message",
													"value": "源文件IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv与目标文件大小不一致"
												},
												{
													"name": "status",
													"value": "Failed"
												}
											],
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ActivityName",
														"type": "String"
													},
													"sink": {
														"name": "ActivityName"
													}
												},
												{
													"source": {
														"name": "PiplineName",
														"type": "String"
													},
													"sink": {
														"name": "PiplineName"
													}
												},
												{
													"source": {
														"name": "Date",
														"type": "String"
													},
													"sink": {
														"name": "Date"
													}
												},
												{
													"source": {
														"name": "Timestampse",
														"type": "String"
													},
													"sink": {
														"name": "Timestampse"
													}
												},
												{
													"source": {
														"name": "ErrorCode",
														"type": "String"
													},
													"sink": {
														"name": "ErrorCode"
													}
												},
												{
													"source": {
														"name": "Message",
														"type": "String"
													},
													"sink": {
														"name": "Message"
													}
												},
												{
													"source": {
														"name": "status",
														"type": "String"
													},
													"sink": {
														"name": "status"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "dummp",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Logger",
											"type": "DatasetReference",
											"parameters": {
												"LogPath": {
													"value": "@pipeline().parameters.LogPath",
													"type": "Expression"
												},
												"LogName": {
													"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2_copy1",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "WRITE LOG_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "ARCHIVED",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ArchivedDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ArchivedDataPath": {
													"value": "@pipeline().parameters.ArchivedDataPath",
													"type": "Expression"
												},
												"ArchivedDataName": {
													"value": "@concat(pipeline().parameters.ArchivedDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "ARCHIVED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								},
								{
									"name": "UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "Validated"
											}
										}
									]
								}
							]
						}
					}
				],
				"parameters": {
					"SourceDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\PROCESS"
					},
					"SourceDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv"
					},
					"DestionDataPath": {
						"type": "string"
					},
					"DestionDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ArchivedDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ARCHIVED"
					},
					"ArchivedDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ErrorDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ERROR"
					},
					"ErrorDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"LogPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\LOG\\IRISLOG"
					},
					"LogName": {
						"type": "string",
						"defaultValue": "FWD_BigQuery_Data_"
					}
				},
				"variables": {
					"CurrentDate": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataSet')]",
				"[concat(variables('factoryId'), '/datasets/DestionDataSet')]",
				"[concat(variables('factoryId'), '/datasets/ErrorDataSet')]",
				"[concat(variables('factoryId'), '/datasets/dummp')]",
				"[concat(variables('factoryId'), '/datasets/Logger')]",
				"[concat(variables('factoryId'), '/datasets/ArchivedDataSet')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FWD_UWME_ACTIVE_USERS_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SOURCE FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							}
						]
					},
					{
						"name": "VALIDATION",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "CURREN TTIME",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "VALIDATION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentDate",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ERROR BAK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ErrorDataSet",
								"type": "DatasetReference",
								"parameters": {
									"ErrorDataPath": {
										"value": "@pipeline().parameters.ErrorDataPath",
										"type": "Expression"
									},
									"ErrorDataName": {
										"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "WRITE LOG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "FWD_IRIS01_PIPELINE"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName",
											"type": "String"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName",
											"type": "String"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date",
											"type": "String"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse",
											"type": "String"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode",
											"type": "String"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message",
											"type": "String"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status",
											"type": "String"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dummp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Logger",
								"type": "DatasetReference",
								"parameters": {
									"LogPath": {
										"value": "@pipeline().parameters.LogPath",
										"type": "Expression"
									},
									"LogName": {
										"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "DELETE1",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "ERROR BAK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							}
						}
					},
					{
						"name": "SOURCE FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "CURREN TTIME",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "FileServerReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "DESTION FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "DESTION FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(string(activity('SOURCE FILE SIZE').output.size),string(activity('DESTION FILE SIZE').output.size))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ErrorDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ErrorDataPath": {
													"value": "@pipeline().parameters.ErrorDataPath",
													"type": "Expression"
												},
												"ErrorDataName": {
													"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "WRITE LOG_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "ERROR UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "ActivityName",
													"value": "if Condition1"
												},
												{
													"name": "PiplineName",
													"value": "FWD_IRIS01_PIPELINE"
												},
												{
													"name": "Date",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												},
												{
													"name": "Timestampse",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "ErrorCode",
													"value": "9000"
												},
												{
													"name": "Message",
													"value": "源文件IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv与目标文件大小不一致"
												},
												{
													"name": "status",
													"value": "Failed"
												}
											],
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ActivityName",
														"type": "String"
													},
													"sink": {
														"name": "ActivityName"
													}
												},
												{
													"source": {
														"name": "PiplineName",
														"type": "String"
													},
													"sink": {
														"name": "PiplineName"
													}
												},
												{
													"source": {
														"name": "Date",
														"type": "String"
													},
													"sink": {
														"name": "Date"
													}
												},
												{
													"source": {
														"name": "Timestampse",
														"type": "String"
													},
													"sink": {
														"name": "Timestampse"
													}
												},
												{
													"source": {
														"name": "ErrorCode",
														"type": "String"
													},
													"sink": {
														"name": "ErrorCode"
													}
												},
												{
													"source": {
														"name": "Message",
														"type": "String"
													},
													"sink": {
														"name": "Message"
													}
												},
												{
													"source": {
														"name": "status",
														"type": "String"
													},
													"sink": {
														"name": "status"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "dummp",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Logger",
											"type": "DatasetReference",
											"parameters": {
												"LogPath": {
													"value": "@pipeline().parameters.LogPath",
													"type": "Expression"
												},
												"LogName": {
													"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2_copy1",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "WRITE LOG_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "ARCHIVED",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ArchivedDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ArchivedDataPath": {
													"value": "@pipeline().parameters.ArchivedDataPath",
													"type": "Expression"
												},
												"ArchivedDataName": {
													"value": "@concat(pipeline().parameters.ArchivedDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "ARCHIVED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								},
								{
									"name": "UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "Validated"
											}
										}
									]
								}
							]
						}
					}
				],
				"parameters": {
					"SourceDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\PROCESS"
					},
					"SourceDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv"
					},
					"DestionDataPath": {
						"type": "string"
					},
					"DestionDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ArchivedDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ARCHIVED"
					},
					"ArchivedDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ErrorDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ERROR"
					},
					"ErrorDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"LogPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\LOG\\EAPPLOG"
					},
					"LogName": {
						"type": "string",
						"defaultValue": "FWD_BigQuery_Data_"
					}
				},
				"variables": {
					"CurrentDate": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataSet')]",
				"[concat(variables('factoryId'), '/datasets/DestionDataSet')]",
				"[concat(variables('factoryId'), '/datasets/ErrorDataSet')]",
				"[concat(variables('factoryId'), '/datasets/dummp')]",
				"[concat(variables('factoryId'), '/datasets/Logger')]",
				"[concat(variables('factoryId'), '/datasets/ArchivedDataSet')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FWD_UWME_SUBMISSIONS-RIDER_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "SOURCE FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							}
						]
					},
					{
						"name": "VALIDATION",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "CURREN TTIME",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "VALIDATION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentDate",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ERROR BAK",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "ErrorDataSet",
								"type": "DatasetReference",
								"parameters": {
									"ErrorDataPath": {
										"value": "@pipeline().parameters.ErrorDataPath",
										"type": "Expression"
									},
									"ErrorDataName": {
										"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "WRITE LOG",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "FWD_IRIS01_PIPELINE"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "FileServerWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName",
											"type": "String"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName",
											"type": "String"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date",
											"type": "String"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse",
											"type": "String"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode",
											"type": "String"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message",
											"type": "String"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status",
											"type": "String"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dummp",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Logger",
								"type": "DatasetReference",
								"parameters": {
									"LogPath": {
										"value": "@pipeline().parameters.LogPath",
										"type": "Expression"
									},
									"LogName": {
										"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "DELETE1",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "ERROR BAK",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							}
						}
					},
					{
						"name": "SOURCE FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "CURREN TTIME",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "SourceDataSet",
								"type": "DatasetReference",
								"parameters": {
									"SourceDataPath": {
										"value": "@pipeline().parameters.SourceDataPath",
										"type": "Expression"
									},
									"SourceDataName": {
										"value": "@pipeline().parameters.SourceDataName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "FileServerReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "DESTION FILE SIZE",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "DestionDataSet",
								"type": "DatasetReference",
								"parameters": {
									"DestionDataName": {
										"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
										"type": "Expression"
									},
									"DestionDataPath": "UnValidated"
								}
							},
							"fieldList": [
								"size",
								"itemType"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "DESTION FILE SIZE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(string(activity('SOURCE FILE SIZE').output.size),string(activity('DESTION FILE SIZE').output.size))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ErrorDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ErrorDataPath": {
													"value": "@pipeline().parameters.ErrorDataPath",
													"type": "Expression"
												},
												"ErrorDataName": {
													"value": "@concat(pipeline().parameters.ErrorDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "WRITE LOG_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "ERROR UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"additionalColumns": [
												{
													"name": "ActivityName",
													"value": "if Condition1"
												},
												{
													"name": "PiplineName",
													"value": "FWD_IRIS01_PIPELINE"
												},
												{
													"name": "Date",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
														"type": "Expression"
													}
												},
												{
													"name": "Timestampse",
													"value": {
														"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
														"type": "Expression"
													}
												},
												{
													"name": "ErrorCode",
													"value": "9000"
												},
												{
													"name": "Message",
													"value": "源文件IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv与目标文件大小不一致"
												},
												{
													"name": "status",
													"value": "Failed"
												}
											],
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "ActivityName",
														"type": "String"
													},
													"sink": {
														"name": "ActivityName"
													}
												},
												{
													"source": {
														"name": "PiplineName",
														"type": "String"
													},
													"sink": {
														"name": "PiplineName"
													}
												},
												{
													"source": {
														"name": "Date",
														"type": "String"
													},
													"sink": {
														"name": "Date"
													}
												},
												{
													"source": {
														"name": "Timestampse",
														"type": "String"
													},
													"sink": {
														"name": "Timestampse"
													}
												},
												{
													"source": {
														"name": "ErrorCode",
														"type": "String"
													},
													"sink": {
														"name": "ErrorCode"
													}
												},
												{
													"source": {
														"name": "Message",
														"type": "String"
													},
													"sink": {
														"name": "Message"
													}
												},
												{
													"source": {
														"name": "status",
														"type": "String"
													},
													"sink": {
														"name": "status"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "dummp",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Logger",
											"type": "DatasetReference",
											"parameters": {
												"LogPath": {
													"value": "@pipeline().parameters.LogPath",
													"type": "Expression"
												},
												"LogName": {
													"value": "@concat(pipeline().parameters.LogName,formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2_copy1",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "WRITE LOG_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "ARCHIVED",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "UNVALIDATED TO VALIDATED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "FileServerWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ArchivedDataSet",
											"type": "DatasetReference",
											"parameters": {
												"ArchivedDataPath": {
													"value": "@pipeline().parameters.ArchivedDataPath",
													"type": "Expression"
												},
												"ArchivedDataName": {
													"value": "@concat(pipeline().parameters.ArchivedDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "DELETE2",
									"type": "Delete",
									"dependsOn": [
										{
											"activity": "ARCHIVED",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": "UnValidated",
												"SourceDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"enableLogging": false,
										"storeSettings": {
											"type": "FileServerReadSettings",
											"recursive": true
										}
									}
								},
								{
									"name": "UNVALIDATED TO VALIDATED",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "FileServerReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "SourceDataSet",
											"type": "DatasetReference",
											"parameters": {
												"SourceDataPath": {
													"value": "@pipeline().parameters.SourceDataPath",
													"type": "Expression"
												},
												"SourceDataName": {
													"value": "@pipeline().parameters.SourceDataName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "DestionDataSet",
											"type": "DatasetReference",
											"parameters": {
												"DestionDataName": {
													"value": "@concat(pipeline().parameters.DestionDataName,variables('CurrentDate'),'.csv')",
													"type": "Expression"
												},
												"DestionDataPath": "Validated"
											}
										}
									]
								}
							]
						}
					}
				],
				"parameters": {
					"SourceDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\PROCESS"
					},
					"SourceDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv"
					},
					"DestionDataPath": {
						"type": "string"
					},
					"DestionDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ArchivedDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ARCHIVED"
					},
					"ArchivedDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ErrorDataPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\IRIS\\ERROR"
					},
					"ErrorDataName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"LogPath": {
						"type": "string",
						"defaultValue": "DATA\\PH\\FWD\\LOG\\EAPPLOG"
					},
					"LogName": {
						"type": "string",
						"defaultValue": "FWD_BigQuery_Data_"
					}
				},
				"variables": {
					"CurrentDate": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataSet')]",
				"[concat(variables('factoryId'), '/datasets/DestionDataSet')]",
				"[concat(variables('factoryId'), '/datasets/ErrorDataSet')]",
				"[concat(variables('factoryId'), '/datasets/dummp')]",
				"[concat(variables('factoryId'), '/datasets/Logger')]",
				"[concat(variables('factoryId'), '/datasets/ArchivedDataSet')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Test_ADFBRANCH_PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CURRENTTIME",
							"value": "2020-08-05"
						}
					},
					{
						"name": "Set variable1_copy1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set variable1_copy2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CURRENTTIME",
							"value": "2020-08-07"
						}
					},
					{
						"name": "Set variable1_copy2",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set variable1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CURRENTTIME",
							"value": "2020-08-06"
						}
					}
				],
				"variables": {
					"CURRENTTIME": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Test_ADFBRANCH_PIPELINE2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Set variable1",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CURRENTTIME",
							"value": "2020-08-05"
						}
					}
				],
				"variables": {
					"CURRENTTIME": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FormalPipeline"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1_E-App')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetSourceFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"logStorageSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "demoadf/log"
							},
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "ERROR Bak",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InputDelimitedTextErrorOutput",
								"type": "DatasetReference",
								"parameters": {
									"ErrorFileName": {
										"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Validation1",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "logVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed",
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "log",
							"value": {
								"value": "@string(activity('Copy data1').output)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WriteLog",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "logVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "logdetailssssssssaa",
										"value": {
											"value": "@variables('log')",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": "werqwerewre.csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dump",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Log",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetSourceFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "SetCurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "GetDestionFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "CompareSourceAndDestionFileMD5",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "GetDestionFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('GetSourceFileMD5').output.contentMD5,activity('GetDestionFileMD5').output.contentMD5)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR Bak_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "inputDelimitedTextInput",
											"type": "DatasetReference",
											"parameters": {
												"SourceFilePath": {
													"value": "@pipeline().parameters.SourceFilePath",
													"type": "Expression"
												},
												"SourceFileName": {
													"value": "@pipeline().parameters.SourceFileName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "InputDelimitedTextErrorOutput",
											"type": "DatasetReference",
											"parameters": {
												"ErrorFileName": {
													"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "SetCurrentTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Validation1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					}
				],
				"parameters": {
					"SourceFilePath": {
						"type": "string",
						"defaultValue": "input"
					},
					"SourceFileName": {
						"type": "string",
						"defaultValue": "E-App Extract June 2020 (07272020).xlsx"
					},
					"DestionFilePath": {
						"type": "string",
						"defaultValue": "stg"
					},
					"DestionFileName": {
						"type": "string",
						"defaultValue": "E-App Extract June 2020 (07272020)"
					}
				},
				"variables": {
					"log": {
						"type": "String"
					},
					"FileMD5": {
						"type": "String"
					},
					"CurrentTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "demo"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextInput')]",
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextoutput')]",
				"[concat(variables('factoryId'), '/datasets/InputDelimitedTextErrorOutput')]",
				"[concat(variables('factoryId'), '/datasets/dump')]",
				"[concat(variables('factoryId'), '/datasets/Log')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1_E-App_Non-UWMe_Active_User')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetSourceFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"logStorageSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "demoadf/log"
							},
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "ERROR Bak",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InputDelimitedTextErrorOutput",
								"type": "DatasetReference",
								"parameters": {
									"ErrorFileName": {
										"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Validation1",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "logVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed",
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "log",
							"value": {
								"value": "@string(activity('Copy data1').output)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WriteLog",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "logVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "logdetailssssssssaa",
										"value": {
											"value": "@variables('log')",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": "werqwerewre.csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dump",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Log",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetSourceFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "SetCurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "GetDestionFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "CompareSourceAndDestionFileMD5",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "GetDestionFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('GetSourceFileMD5').output.contentMD5,activity('GetDestionFileMD5').output.contentMD5)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR Bak_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "inputDelimitedTextInput",
											"type": "DatasetReference",
											"parameters": {
												"SourceFilePath": {
													"value": "@pipeline().parameters.SourceFilePath",
													"type": "Expression"
												},
												"SourceFileName": {
													"value": "@pipeline().parameters.SourceFileName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "InputDelimitedTextErrorOutput",
											"type": "DatasetReference",
											"parameters": {
												"ErrorFileName": {
													"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "SetCurrentTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Validation1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					}
				],
				"parameters": {
					"SourceFilePath": {
						"type": "string",
						"defaultValue": "input"
					},
					"SourceFileName": {
						"type": "string",
						"defaultValue": "E-App Extract June 2020 (07272020).xlsx"
					},
					"DestionFilePath": {
						"type": "string",
						"defaultValue": "stg"
					},
					"DestionFileName": {
						"type": "string",
						"defaultValue": "E-App Extract June 2020 (07272020)"
					}
				},
				"variables": {
					"log": {
						"type": "String"
					},
					"FileMD5": {
						"type": "String"
					},
					"CurrentTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "demo"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextInput')]",
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextoutput')]",
				"[concat(variables('factoryId'), '/datasets/InputDelimitedTextErrorOutput')]",
				"[concat(variables('factoryId'), '/datasets/dump')]",
				"[concat(variables('factoryId'), '/datasets/Log')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1_E-App_UWMe_Active_Users')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetSourceFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"logStorageSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "demoadf/log"
							},
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "ERROR Bak",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InputDelimitedTextErrorOutput",
								"type": "DatasetReference",
								"parameters": {
									"ErrorFileName": {
										"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Validation1",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "logVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed",
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "log",
							"value": {
								"value": "@string(activity('Copy data1').output)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WriteLog",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "logVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "logdetailssssssssaa",
										"value": {
											"value": "@variables('log')",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": "werqwerewre.csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dump",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Log",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetSourceFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "SetCurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "GetDestionFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "CompareSourceAndDestionFileMD5",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "GetDestionFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('GetSourceFileMD5').output.contentMD5,activity('GetDestionFileMD5').output.contentMD5)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR Bak_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "inputDelimitedTextInput",
											"type": "DatasetReference",
											"parameters": {
												"SourceFilePath": {
													"value": "@pipeline().parameters.SourceFilePath",
													"type": "Expression"
												},
												"SourceFileName": {
													"value": "@pipeline().parameters.SourceFileName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "InputDelimitedTextErrorOutput",
											"type": "DatasetReference",
											"parameters": {
												"ErrorFileName": {
													"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "SetCurrentTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Validation1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					}
				],
				"parameters": {
					"SourceFilePath": {
						"type": "string",
						"defaultValue": "input"
					},
					"SourceFileName": {
						"type": "string",
						"defaultValue": "E-App Extract June 2020 (07272020).xlsx"
					},
					"DestionFilePath": {
						"type": "string",
						"defaultValue": "stg"
					},
					"DestionFileName": {
						"type": "string",
						"defaultValue": "E-App Extract June 2020 (07272020)"
					}
				},
				"variables": {
					"log": {
						"type": "String"
					},
					"FileMD5": {
						"type": "String"
					},
					"CurrentTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "demo"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextInput')]",
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextoutput')]",
				"[concat(variables('factoryId'), '/datasets/InputDelimitedTextErrorOutput')]",
				"[concat(variables('factoryId'), '/datasets/dump')]",
				"[concat(variables('factoryId'), '/datasets/Log')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1_E-App_UWMe_Submissions-rIDER')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetSourceFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"logStorageSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "demoadf/log"
							},
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "ERROR Bak",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InputDelimitedTextErrorOutput",
								"type": "DatasetReference",
								"parameters": {
									"ErrorFileName": {
										"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Validation1",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "logVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed",
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "log",
							"value": {
								"value": "@string(activity('Copy data1').output)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WriteLog",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "logVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "logdetailssssssssaa",
										"value": {
											"value": "@variables('log')",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": "werqwerewre.csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dump",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Log",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetSourceFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "SetCurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "GetDestionFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "CompareSourceAndDestionFileMD5",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "GetDestionFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('GetSourceFileMD5').output.contentMD5,activity('GetDestionFileMD5').output.contentMD5)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR Bak_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "inputDelimitedTextInput",
											"type": "DatasetReference",
											"parameters": {
												"SourceFilePath": {
													"value": "@pipeline().parameters.SourceFilePath",
													"type": "Expression"
												},
												"SourceFileName": {
													"value": "@pipeline().parameters.SourceFileName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "InputDelimitedTextErrorOutput",
											"type": "DatasetReference",
											"parameters": {
												"ErrorFileName": {
													"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "SetCurrentTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Validation1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					}
				],
				"parameters": {
					"SourceFilePath": {
						"type": "string",
						"defaultValue": "input"
					},
					"SourceFileName": {
						"type": "string",
						"defaultValue": "E-App Extract June 2020 (07272020).xlsx"
					},
					"DestionFilePath": {
						"type": "string",
						"defaultValue": "stg"
					},
					"DestionFileName": {
						"type": "string",
						"defaultValue": "E-App Extract June 2020 (07272020)"
					}
				},
				"variables": {
					"log": {
						"type": "String"
					},
					"FileMD5": {
						"type": "String"
					},
					"CurrentTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "demo"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextInput')]",
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextoutput')]",
				"[concat(variables('factoryId'), '/datasets/InputDelimitedTextErrorOutput')]",
				"[concat(variables('factoryId'), '/datasets/dump')]",
				"[concat(variables('factoryId'), '/datasets/Log')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1_E-App_nON-UWMe_Submissions-rIDER_copy1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetSourceFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"logStorageSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "demoadf/log"
							},
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "ERROR Bak",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InputDelimitedTextErrorOutput",
								"type": "DatasetReference",
								"parameters": {
									"ErrorFileName": {
										"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Validation1",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "logVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed",
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "log",
							"value": {
								"value": "@string(activity('Copy data1').output)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WriteLog",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "logVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "logdetailssssssssaa",
										"value": {
											"value": "@variables('log')",
											"type": "Expression"
										}
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": "werqwerewre.csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dump",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Log",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetSourceFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "SetCurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "GetDestionFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "CompareSourceAndDestionFileMD5",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "GetDestionFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('GetSourceFileMD5').output.contentMD5,activity('GetDestionFileMD5').output.contentMD5)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR Bak_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "inputDelimitedTextInput",
											"type": "DatasetReference",
											"parameters": {
												"SourceFilePath": {
													"value": "@pipeline().parameters.SourceFilePath",
													"type": "Expression"
												},
												"SourceFileName": {
													"value": "@pipeline().parameters.SourceFileName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "InputDelimitedTextErrorOutput",
											"type": "DatasetReference",
											"parameters": {
												"ErrorFileName": {
													"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "SetCurrentTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Validation1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					}
				],
				"parameters": {
					"SourceFilePath": {
						"type": "string",
						"defaultValue": "input"
					},
					"SourceFileName": {
						"type": "string",
						"defaultValue": "E-App Extract June 2020 (07272020).xlsx"
					},
					"DestionFilePath": {
						"type": "string",
						"defaultValue": "stg"
					},
					"DestionFileName": {
						"type": "string",
						"defaultValue": "E-App Extract June 2020 (07272020)"
					}
				},
				"variables": {
					"log": {
						"type": "String"
					},
					"FileMD5": {
						"type": "String"
					},
					"CurrentTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "demo"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextInput')]",
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextoutput')]",
				"[concat(variables('factoryId'), '/datasets/InputDelimitedTextErrorOutput')]",
				"[concat(variables('factoryId'), '/datasets/dump')]",
				"[concat(variables('factoryId'), '/datasets/Log')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1_IRIS01')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetSourceFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"logStorageSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "demoadf/log"
							},
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "agency_name",
											"physicalType": "String"
										},
										"sink": {
											"name": "agency_name",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "activity_date",
											"physicalType": "String"
										},
										"sink": {
											"name": "activity_date",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "no_of_contacts",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "no_of_contacts",
											"type": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "ERROR Bak",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InputDelimitedTextErrorOutput",
								"type": "DatasetReference",
								"parameters": {
									"ErrorFileName": {
										"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Validation1",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "logVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "log",
							"value": {
								"value": "@string(activity('Copy data1').output)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WriteLog",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "logVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "pipeline1_IRIS01"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ActivityName"
										},
										"sink": {
											"name": "ActivityName"
										}
									},
									{
										"source": {
											"name": "PiplineName"
										},
										"sink": {
											"name": "PiplineName"
										}
									},
									{
										"source": {
											"name": "Date"
										},
										"sink": {
											"name": "Date"
										}
									},
									{
										"source": {
											"name": "Timestampse"
										},
										"sink": {
											"name": "Timestampse"
										}
									},
									{
										"source": {
											"name": "ErrorCode"
										},
										"sink": {
											"name": "ErrorCode"
										}
									},
									{
										"source": {
											"name": "Message"
										},
										"sink": {
											"name": "Message"
										}
									},
									{
										"source": {
											"name": "status"
										},
										"sink": {
											"name": "status"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dump",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Log",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GetSourceFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "SetCurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "GetDestionFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "CompareSourceAndDestionFileMD5",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "GetDestionFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('GetSourceFileMD5').output.contentMD5,activity('GetDestionFileMD5').output.contentMD5)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR Bak_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Delete1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "inputDelimitedTextInput",
											"type": "DatasetReference",
											"parameters": {
												"SourceFilePath": {
													"value": "@pipeline().parameters.SourceFilePath",
													"type": "Expression"
												},
												"SourceFileName": {
													"value": "@pipeline().parameters.SourceFileName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "InputDelimitedTextErrorOutput",
											"type": "DatasetReference",
											"parameters": {
												"ErrorFileName": {
													"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Delete1",
									"type": "Delete",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "inputDelimitedTextoutput",
											"type": "DatasetReference",
											"parameters": {
												"DestionFilePath": {
													"value": "@pipeline().parameters.DestionFilePath",
													"type": "Expression"
												},
												"DestionFileName": {
													"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"enableLogging": true,
										"storeSettings": {
											"type": "AzureBlobStorageReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Copy data1_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "agency_name",
														"physicalType": "String"
													},
													"sink": {
														"name": "agency_name",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "activity_date",
														"physicalType": "String"
													},
													"sink": {
														"name": "activity_date",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "no_of_contacts",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "no_of_contacts",
														"type": "String"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "inputDelimitedTextInput",
											"type": "DatasetReference",
											"parameters": {
												"SourceFilePath": {
													"value": "@pipeline().parameters.SourceFilePath",
													"type": "Expression"
												},
												"SourceFileName": {
													"value": "@pipeline().parameters.SourceFileName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "inputDelimitedTextoutput",
											"type": "DatasetReference",
											"parameters": {
												"DestionFilePath": {
													"value": "@pipeline().parameters.ArchivedFilePath",
													"type": "Expression"
												},
												"DestionFileName": {
													"value": "@concat(pipeline().parameters.ArchivedFileName,string(formatDateTime(utcnow(),'yyyy-MM-dd')),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "SetCurrentTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Validation1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					}
				],
				"parameters": {
					"SourceFilePath": {
						"type": "string",
						"defaultValue": "input"
					},
					"SourceFileName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date.csv"
					},
					"DestionFilePath": {
						"type": "string",
						"defaultValue": "stg"
					},
					"DestionFileName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					},
					"ArchivedFilePath": {
						"type": "string",
						"defaultValue": "ArchivedFilePath"
					},
					"ArchivedFileName": {
						"type": "string",
						"defaultValue": "IRIS01-No_of_Leads_Contacted_By_Agency_By_Date"
					}
				},
				"variables": {
					"log": {
						"type": "String"
					},
					"FileMD5": {
						"type": "String"
					},
					"CurrentTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "demo"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextInput')]",
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextoutput')]",
				"[concat(variables('factoryId'), '/datasets/InputDelimitedTextErrorOutput')]",
				"[concat(variables('factoryId'), '/datasets/dump')]",
				"[concat(variables('factoryId'), '/datasets/Log')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1_IRIS02')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetSourceFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"logStorageSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "demoadf/log"
							},
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "ERROR Bak",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InputDelimitedTextErrorOutput",
								"type": "DatasetReference",
								"parameters": {
									"ErrorFileName": {
										"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Validation1",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "GetSourceFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "SetCurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "GetDestionFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "CompareSourceAndDestionFileMD5",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "GetDestionFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('GetSourceFileMD5').output.contentMD5,activity('GetDestionFileMD5').output.contentMD5)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR Bak_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Delete1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "inputDelimitedTextInput",
											"type": "DatasetReference",
											"parameters": {
												"SourceFilePath": {
													"value": "@pipeline().parameters.SourceFilePath",
													"type": "Expression"
												},
												"SourceFileName": {
													"value": "@pipeline().parameters.SourceFileName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "InputDelimitedTextErrorOutput",
											"type": "DatasetReference",
											"parameters": {
												"ErrorFileName": {
													"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"name": "Delete1",
									"type": "Delete",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "inputDelimitedTextoutput",
											"type": "DatasetReference",
											"parameters": {
												"DestionFilePath": {
													"value": "@pipeline().parameters.DestionFilePath",
													"type": "Expression"
												},
												"DestionFileName": {
													"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										},
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"enableLogging": true,
										"storeSettings": {
											"type": "AzureBlobStorageReadSettings",
											"recursive": true
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Copy data1_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "AzureBlobStorage1",
												"type": "LinkedServiceReference"
											},
											"path": "demoadf/log"
										},
										"validateDataConsistency": true,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "agency_name",
														"physicalType": "String"
													},
													"sink": {
														"name": "agency_name",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "activity_date",
														"physicalType": "String"
													},
													"sink": {
														"name": "activity_date",
														"type": "String"
													}
												},
												{
													"source": {
														"name": "no_of_contacts",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "no_of_contacts",
														"type": "String"
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "inputDelimitedTextInput",
											"type": "DatasetReference",
											"parameters": {
												"SourceFilePath": {
													"value": "@pipeline().parameters.SourceFilePath",
													"type": "Expression"
												},
												"SourceFileName": {
													"value": "@pipeline().parameters.SourceFileName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "inputDelimitedTextoutput",
											"type": "DatasetReference",
											"parameters": {
												"DestionFilePath": {
													"value": "@pipeline().parameters.ArchivedFilePath",
													"type": "Expression"
												},
												"DestionFileName": {
													"value": "@concat(pipeline().parameters.ArchivedFileName,string(formatDateTime(utcnow(),'yyyy-MM-dd')),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "SetCurrentTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Validation1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "logVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "log",
							"value": {
								"value": "@string(activity('Copy data1').output)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WriteLog",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "logVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "pipeline1_IRIS01"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dump",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Log",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"parameters": {
					"SourceFilePath": {
						"type": "string",
						"defaultValue": "input"
					},
					"SourceFileName": {
						"type": "string",
						"defaultValue": "IRIS02-No_of_Leads_With_Appt_By_Agency_By_Date.csv"
					},
					"DestionFilePath": {
						"type": "string",
						"defaultValue": "stg"
					},
					"DestionFileName": {
						"type": "string",
						"defaultValue": "IRIS02-No_of_Leads_With_Appt_By_Agency_By_Date"
					},
					"ArchivedFilePath": {
						"type": "string"
					},
					"ArchivedFileName": {
						"type": "string"
					}
				},
				"variables": {
					"log": {
						"type": "String"
					},
					"FileMD5": {
						"type": "String"
					},
					"CurrentTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "demo"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextInput')]",
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextoutput')]",
				"[concat(variables('factoryId'), '/datasets/InputDelimitedTextErrorOutput')]",
				"[concat(variables('factoryId'), '/datasets/dump')]",
				"[concat(variables('factoryId'), '/datasets/Log')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1_IRIS03')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetSourceFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"logStorageSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "demoadf/log"
							},
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "ERROR Bak",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InputDelimitedTextErrorOutput",
								"type": "DatasetReference",
								"parameters": {
									"ErrorFileName": {
										"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Validation1",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "GetSourceFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "SetCurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "GetDestionFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "CompareSourceAndDestionFileMD5",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "GetDestionFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('GetSourceFileMD5').output.contentMD5,activity('GetDestionFileMD5').output.contentMD5)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR Bak_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "inputDelimitedTextInput",
											"type": "DatasetReference",
											"parameters": {
												"SourceFilePath": {
													"value": "@pipeline().parameters.SourceFilePath",
													"type": "Expression"
												},
												"SourceFileName": {
													"value": "@pipeline().parameters.SourceFileName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "InputDelimitedTextErrorOutput",
											"type": "DatasetReference",
											"parameters": {
												"ErrorFileName": {
													"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "SetCurrentTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Validation1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "logVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "log",
							"value": {
								"value": "@string(activity('Copy data1').output)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WriteLog",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "logVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "pipeline1_IRIS01"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dump",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Log",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"parameters": {
					"SourceFilePath": {
						"type": "string",
						"defaultValue": "input"
					},
					"SourceFileName": {
						"type": "string",
						"defaultValue": "IRIS03-Tasks_Completed_By_Agency_By_Date.csv"
					},
					"DestionFilePath": {
						"type": "string",
						"defaultValue": "stg"
					},
					"DestionFileName": {
						"type": "string",
						"defaultValue": "IRIS03-Tasks_Completed_By_Agency_By_Date"
					}
				},
				"variables": {
					"log": {
						"type": "String"
					},
					"FileMD5": {
						"type": "String"
					},
					"CurrentTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "demo"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextInput')]",
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextoutput')]",
				"[concat(variables('factoryId'), '/datasets/InputDelimitedTextErrorOutput')]",
				"[concat(variables('factoryId'), '/datasets/dump')]",
				"[concat(variables('factoryId'), '/datasets/Log')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline3')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CurrentTime",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyy-MM-dd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "GetEventKey",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "GoogleBigQuerySource",
								"query": "select distinct key from (\nSELECT event_date,event_timestamp,event_name,event_params.key as key,concat((case when event_params.value.string_value is null then '' else event_params.value.string_value end),(case when cast(event_params.value.int_value as string) is null then '' else cast(event_params.value.int_value as string) end),(case when cast(event_params.value.float_value as string) is null then '' else cast(event_params.value.float_value as string) end),(case when cast(event_params.value.double_value as string) is null then '' else cast(event_params.value.double_value as string) end)) as value FROM `firebase-public-project.analytics_153293282.events_20181003` , unnest(event_params) as event_params \n) "
							},
							"dataset": {
								"referenceName": "GoogleBigQueryInput",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Set variable EventKey",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "GetEventKey",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "EventKey",
							"value": {
								"value": "@activity('GetEventKey').output.value",
								"type": "Expression"
							}
						}
					},
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Set variable EventKey",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@variables('EventKey')",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Set variable1",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "SqlTwo",
										"value": {
											"value": "@concat(variables('TempSql'),'  max((case when key=\"',item().key,'\"  then value else null end) ) as \n ',item().key,' , ')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set variable1_copy1",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Set variable1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "TempSql",
										"value": {
											"value": "@variables('SqlTwo')",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Set variable2",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "ForEach1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "FinallSql",
							"value": {
								"value": "@concat(variables('SqlOne') , variables('SqlTwo') , variables('SqlThree'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set variable2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "GoogleBigQuerySource",
								"query": {
									"value": "@variables('FinallSql')",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "GoogleBigQueryInput",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@pipeline().parameters.DestionFileName",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"parameters": {
					"DestionFilePath": {
						"type": "string",
						"defaultValue": "output"
					},
					"DestionFileName": {
						"type": "string",
						"defaultValue": "testdemofinall.csv"
					}
				},
				"variables": {
					"CurrentTime": {
						"type": "String"
					},
					"EventKey": {
						"type": "Array"
					},
					"BigQuerySqlForFormalData": {
						"type": "String"
					},
					"TempSql": {
						"type": "String",
						"defaultValue": "   "
					},
					"SqlOne": {
						"type": "String",
						"defaultValue": "select event_date,event_timestamp,event_name, "
					},
					"SqlTwo": {
						"type": "String",
						"defaultValue": "    "
					},
					"SqlThree": {
						"type": "String",
						"defaultValue": "max((case when key='value' then value else null end) ) as value111   from( SELECT event_date,event_timestamp,event_name  ,event_params.key as key,concat((case when event_params.value.string_value is null then '' else event_params.value.string_value end),(case when cast(event_params.value.int_value as string) is null then '' else cast(event_params.value.int_value as string) end),(case when cast(event_params.value.float_value as string) is null then '' else cast(event_params.value.float_value as string) end),(case when cast(event_params.value.double_value as string) is null then '' else cast(event_params.value.double_value as string) end)) as value FROM `firebase-public-project.analytics_153293282.events_20181003` , unnest(event_params) as event_params  )  group by event_date,event_timestamp,event_name"
					},
					"FinallSql": {
						"type": "String"
					}
				},
				"folder": {
					"name": "demo"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/GoogleBigQueryInput')]",
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextoutput')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline4')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "GoogleBigQuerySource",
								"query": "SELECT * FROM `firstprojectlwy.analytics_240895117.events_20200731`"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								}
							},
							"enableStaging": false,
							"logStorageSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "demoadf/output"
							},
							"validateDataConsistency": true
						},
						"inputs": [
							{
								"referenceName": "GoogleBigQueryInput",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Parquet2Test",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CurrentTime",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyy-MM-dd'))",
								"type": "Expression"
							}
						}
					}
				],
				"parameters": {
					"DestionFilePath": {
						"type": "string",
						"defaultValue": "output"
					},
					"DestionFileName": {
						"type": "string"
					}
				},
				"variables": {
					"CurrentTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "demo"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/GoogleBigQueryInput')]",
				"[concat(variables('factoryId'), '/datasets/Parquet2Test')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline_IRIS05')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "GetSourceFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"logStorageSettings": {
								"linkedServiceName": {
									"referenceName": "AzureBlobStorage1",
									"type": "LinkedServiceReference"
								},
								"path": "demoadf/log"
							},
							"validateDataConsistency": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "ERROR Bak",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InputDelimitedTextErrorOutput",
								"type": "DatasetReference",
								"parameters": {
									"ErrorFileName": {
										"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							}
						]
					},
					{
						"name": "Validation1",
						"type": "Validation",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"timeout": "7.00:00:00",
							"sleep": 10
						}
					},
					{
						"name": "GetSourceFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "SetCurrentTime",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextInput",
								"type": "DatasetReference",
								"parameters": {
									"SourceFilePath": {
										"value": "@pipeline().parameters.SourceFilePath",
										"type": "Expression"
									},
									"SourceFileName": {
										"value": "@pipeline().parameters.SourceFileName",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "GetDestionFileMD5",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "inputDelimitedTextoutput",
								"type": "DatasetReference",
								"parameters": {
									"DestionFilePath": {
										"value": "@pipeline().parameters.DestionFilePath",
										"type": "Expression"
									},
									"DestionFileName": {
										"value": "@concat(pipeline().parameters.DestionFileName,variables('CurrentTime'),'.csv')",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"contentMD5"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "CompareSourceAndDestionFileMD5",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "GetDestionFileMD5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('GetSourceFileMD5').output.contentMD5,activity('GetDestionFileMD5').output.contentMD5)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "ERROR Bak_copy1",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".csv"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "inputDelimitedTextInput",
											"type": "DatasetReference",
											"parameters": {
												"SourceFilePath": {
													"value": "@pipeline().parameters.SourceFilePath",
													"type": "Expression"
												},
												"SourceFileName": {
													"value": "@pipeline().parameters.SourceFileName",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "InputDelimitedTextErrorOutput",
											"type": "DatasetReference",
											"parameters": {
												"ErrorFileName": {
													"value": "@concat(pipeline().parameters.SourceFileName,variables('CurrentTime'),'.csv')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "SetCurrentTime",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Validation1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "CurrentTime",
							"value": {
								"value": "@string(formatDateTime(utcnow(),'yyyyMMdd'))",
								"type": "Expression"
							}
						}
					},
					{
						"name": "logVariables",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Copy data1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "log",
							"value": {
								"value": "@string(activity('Copy data1').output)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "WriteLog",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "logVariables",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"additionalColumns": [
									{
										"name": "ActivityName",
										"value": {
											"value": "Copy data1",
											"type": "Expression"
										}
									},
									{
										"name": "PiplineName",
										"value": "pipeline1_IRIS01"
									},
									{
										"name": "Date",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyy-MM-dd')",
											"type": "Expression"
										}
									},
									{
										"name": "Timestampse",
										"value": {
											"value": "@formatDateTime(utcnow(),'yyyyMMddHHmmss')",
											"type": "Expression"
										}
									},
									{
										"name": "ErrorCode",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Code",
											"type": "Expression"
										}
									},
									{
										"name": "Message",
										"value": {
											"value": "@activity('Copy data1').output.errors[0].Message",
											"type": "Expression"
										}
									},
									{
										"name": "status",
										"value": "Failed"
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "MergeFiles"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "dump",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Log",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"parameters": {
					"SourceFilePath": {
						"type": "string",
						"defaultValue": "input"
					},
					"SourceFileName": {
						"type": "string",
						"defaultValue": "IRIS05-Agency_Activities_By_Date.csv"
					},
					"DestionFilePath": {
						"type": "string",
						"defaultValue": "stg"
					},
					"DestionFileName": {
						"type": "string",
						"defaultValue": "IRIS05-Agency_Activities_By_Date"
					}
				},
				"variables": {
					"log": {
						"type": "String"
					},
					"FileMD5": {
						"type": "String"
					},
					"CurrentTime": {
						"type": "String"
					}
				},
				"folder": {
					"name": "demo"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextInput')]",
				"[concat(variables('factoryId'), '/datasets/inputDelimitedTextoutput')]",
				"[concat(variables('factoryId'), '/datasets/InputDelimitedTextErrorOutput')]",
				"[concat(variables('factoryId'), '/datasets/dump')]",
				"[concat(variables('factoryId'), '/datasets/Log')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ArchivedDataSet')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "FileServer1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ArchivedDataPath": {
						"type": "string"
					},
					"ArchivedDataName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "FormalDataSets"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "FileServerLocation",
						"fileName": {
							"value": "@dataset().ArchivedDataName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().ArchivedDataPath",
							"type": "Expression"
						}
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/FileServer1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Avro1Test')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Test"
				},
				"annotations": [],
				"type": "Avro",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "avro123.avro",
						"folderPath": "output",
						"container": "fwdddp"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DestionDataSet')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"DestionDataName": {
						"type": "string"
					},
					"DestionDataPath": {
						"type": "string"
					}
				},
				"folder": {
					"name": "FormalDataSets"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@dataset().DestionDataName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().DestionDataPath",
							"type": "Expression"
						},
						"container": "fwdddp"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ErrorDataSet')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "FileServer1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ErrorDataPath": {
						"type": "string"
					},
					"ErrorDataName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "FormalDataSets"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "FileServerLocation",
						"fileName": {
							"value": "@dataset().ErrorDataName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().ErrorDataPath",
							"type": "Expression"
						}
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/FileServer1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GoogleBigQueryInput')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "GoogleBigQueryForToken",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "BiqueryDemo"
				},
				"annotations": [],
				"type": "GoogleBigQueryObject",
				"schema": [],
				"typeProperties": {
					"dataset": "FirstDataSetDemo",
					"table": "FirstTableDemo"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/GoogleBigQueryForToken')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GoogleBigQueryObject1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "GoogleBigQuery1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "BiqueryDemo"
				},
				"annotations": [],
				"type": "GoogleBigQueryObject",
				"schema": [],
				"typeProperties": {
					"dataset": "myFirstDataSet222",
					"table": "test"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/GoogleBigQuery1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GoogleBigQueryOutPut')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"DestionFilePath": {
						"type": "string"
					},
					"DestionFileName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "BiqueryDemo"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@dataset().DestionFileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().DestionFilePath",
							"type": "Expression"
						},
						"container": "fwdddp"
					},
					"columnDelimiter": ";",
					"escapeChar": "",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": [
					{
						"name": "activity_date",
						"type": "String"
					},
					{
						"name": "no_of_contacts",
						"type": "String"
					},
					{
						"name": "dw_source_name",
						"type": "String"
					},
					{
						"name": "dw_batch_num",
						"type": "String"
					},
					{
						"name": "dw_create_time",
						"type": "String"
					},
					{
						"name": "agency_name",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/InputDelimitedTextErrorOutput')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ErrorFileName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "FirstDemo"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "errorOutPutBak",
						"container": "demoadf"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Json1Test')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Test"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "lwy123.json",
						"folderPath": "output",
						"container": "fwdddp"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Log')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "log"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@concat('log',formatDateTime(utcnow(),'yyyyMMddHHmmss'),'.csv')",
							"type": "Expression"
						},
						"folderPath": "log",
						"container": "demoadf"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Logger')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "FileServer1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"LogPath": {
						"type": "string"
					},
					"LogName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "FormalDataSets/Log"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "FileServerLocation",
						"fileName": {
							"value": "@dataset().LogName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().LogPath",
							"type": "Expression"
						}
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/FileServer1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Parquet2Test')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Test"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "part2.parquet",
						"folderPath": "output",
						"container": "fwdddp"
					},
					"compressionCodec": "none"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SourceDataSet')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "FileServer1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SourceDataPath": {
						"type": "string"
					},
					"SourceDataName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "FormalDataSets"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "FileServerLocation",
						"fileName": {
							"value": "@dataset().SourceDataName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().SourceDataPath",
							"type": "Expression"
						}
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "agency_name",
						"type": "String"
					},
					{
						"name": "activity_type",
						"type": "String"
					},
					{
						"name": "act_date",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/FileServer1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dummp')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "FileServer1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "FormalDataSets/Log"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "FileServerLocation",
						"fileName": "dummp.txt",
						"folderPath": "DATA\\PH\\FWD\\LOG"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/FileServer1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dump')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "log"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "dump.csv",
						"folderPath": "log",
						"container": "demoadf"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/inputDelimitedTextInput')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SourceFilePath": {
						"type": "string"
					},
					"SourceFileName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "FirstDemo"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@dataset().SourceFileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().SourceFilePath",
							"type": "Expression"
						},
						"container": "demoadf"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "agency_name",
						"type": "String"
					},
					{
						"name": "activity_date",
						"type": "String"
					},
					{
						"name": "no_of_contacts",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/inputDelimitedTextoutput')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"DestionFilePath": {
						"type": "string"
					},
					"DestionFileName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "FirstDemo"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@dataset().DestionFileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().DestionFilePath",
							"type": "Expression"
						},
						"container": "fwdddp"
					},
					"columnDelimiter": ",",
					"escapeChar": "",
					"firstRowAsHeader": true,
					"quoteChar": ""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureBlobStorage1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('AzureBlobStorage1_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureBlobStorage2lwy')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('AzureBlobStorage2lwy_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/FileServer1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "FileServer",
				"typeProperties": {
					"host": "[parameters('FileServer1_properties_typeProperties_host')]",
					"userId": "[parameters('FileServer1_properties_typeProperties_userId')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('FileServer1_password')]"
					}
				},
				"connectVia": {
					"referenceName": "IR3",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/IR3')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GoogleBigQuery1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "GoogleBigQuery",
				"typeProperties": {
					"project": "ageless-venture-284211",
					"requestGoogleDriveScope": true,
					"authenticationType": "ServiceAuthentication",
					"email": "ageless-venture-284211@appspot.gserviceaccount.com",
					"keyFilePath": "C:\\keys\\ageless-venture-284211-60ff35a4e5a2.p12",
					"useSystemTrustStore": true
				},
				"connectVia": {
					"referenceName": "ADFBQIR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/ADFBQIR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/GoogleBigQueryForToken')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "GoogleBigQuery",
				"typeProperties": {
					"project": "firstproject-284403",
					"requestGoogleDriveScope": true,
					"authenticationType": "UserAuthentication",
					"clientId": "[parameters('GoogleBigQueryForToken_properties_typeProperties_clientId')]",
					"clientSecret": {
						"type": "SecureString",
						"value": "[parameters('GoogleBigQueryForToken_clientSecret')]"
					},
					"refreshToken": {
						"type": "SecureString",
						"value": "[parameters('GoogleBigQueryForToken_refreshToken')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/trigger1')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Minute",
						"interval": 1,
						"startTime": "2020-07-23T12:25:00Z",
						"timeZone": "UTC"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/trigger2')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "pipeline_IRIS05",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "BlobEventsTrigger",
				"typeProperties": {
					"blobPathBeginsWith": "/demoadf/blobs/input",
					"blobPathEndsWith": ".csv",
					"ignoreEmptyBlobs": true,
					"scope": "[parameters('trigger2_properties_typeProperties_scope')]",
					"events": [
						"Microsoft.Storage.BlobCreated",
						"Microsoft.Storage.BlobDeleted"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/pipeline_IRIS05')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ADFBQIR')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/IR3')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/integrationRuntime1')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 0
						}
					}
				}
			},
			"dependsOn": []
		}
	]
}